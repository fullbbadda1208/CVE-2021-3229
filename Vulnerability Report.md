# CVE-2021-3229 Vulnerability Report
Hello, This is fullbbadda1208(Young-Woo, KWON). This document is about a CVE-2021-3229(https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3229) that I found.

## Vulnerabilities Summary
Denial of Service in ASUSWRT in ASUS RT-AX3000 Firmware versions 3.0.0.4.384_10177 and earlier versions allows attacker to disrupt the use of device setup services via Continuous login Error.

*Attack Impact : Denial of Service ( Access Restriction, End Session, Operational Disruption ) 


## Affected products
This vulnerability report is for ASUSWRT (BIOS/Firmware System) running on ASUS products. 
Because ASUSWRT is classified differently by installed products, it is difficult to specify specific versions. This vulnerability report was carried out only in version 3.0.0.4.384_10177 of the RT-AX3000 router product released by ASUS. However, the structural configuration of ASUSWRT itself is the same, so I think ASUSWRT installed on other products prior to RT_AX3000 version 3.0.0.4.384_10177 will also be vulnerable. Therefore, the manufacturer (ASUS) needs to investigate all products with ASUSWRT installed.


## Background Info
ASUSWRT(https://www.asus.com/us/ASUSWRT/) is a WEB-based Graphical User Interface(GUI) firmware developed for convenient operation of ASUS equipment. ASUSWRT is currently available in various products of ASUS.
ASUSWRT makes it easy for users to use ASUS products. But I found a structural flaw that could be exploited by an attacker when ASUSWRT was operating. Users need to sign in to use ASUSWRT (ASUS product setting). If the sign in failure error occurs more than 5 times on the [Sign In] page, the user will not be able to sign in for 5 minutes. However, I found an interesting fact that not only the device that failed to sign in, but also all other devices attempting to sign in to the [Sign In] page are restricted from signing in for 5 minutes. I've researched the vulnerability focusing on this.
![image10](https://user-images.githubusercontent.com/67869836/107044359-875cd580-6807-11eb-9038-3e1cc875331d.png)


## Attack Flow
The overall attack flow is that an attacker intentionally repeated login errors to continue restricting the login of all devices attempting to access the ASUSWRT (RT-AX3000 Device Settings Page).
As a result, I was able to carry out an attack that interfered with the connection and use of the application. 
![image11](https://user-images.githubusercontent.com/67869836/107044608-e6224f00-6807-11eb-8337-c293184f9ac3.png)


## Proof of Concept
(This PoC can result in a DoS. Given the vendor's security, I don't show the Source Code of Exploit.)
![image21](https://user-images.githubusercontent.com/67869836/107049129-14eef400-680d-11eb-84ce-ff43305d02ce.png)
As a result of running the exploit, all devices (including mobile app 'ASUS Router') trying to access ASUSWRT (ASUS RT-AX3000 setup page) were blocked from logging in, and the devices that were already logged in were also forcefully logged out and restricted from logging in.
If the attacker keeps running the Exploit program, this attack will continue even if the device is rebooted, and users will never be able to access the device settings page unless the attacker turns off the program.
(https://www.youtube.com/watch?v=n7huIjXVlDw)
